<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <form id="signupForm">
            <h2>Sign Up</h2>
            <div class="form-group">
                <label for="fullName">Full Name</label>
                <input type="text" id="fullName" name="fullName" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" required minlength="3" maxlength="20">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required minlength="6">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="terms" name="termsAccepted" required>
                    I agree to the <a href="#">Terms and Conditions</a>
                </label>
            </div>
            <button type="submit">Sign Up</button>
            <p id="message"></p>
        </form>
        <p>Already have an account? <a href="/login.html">Log in</a></p>
    </div>
    <script>
        document.getElementById("signupForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = {
                fullName: document.getElementById("fullName").value,
                email: document.getElementById("email").value,
                username: document.getElementById("username").value,
                password: document.getElementById("password").value,
                termsAccepted: document.getElementById("terms").checked
            };

            const messageElement = document.getElementById("message");

            try {
                const response = await fetch("/api/signup", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    messageElement.classList.add("success");
                    messageElement.textContent = result.message || "User registered successfully";
                    document.getElementById("signupForm").reset();
                    setTimeout(() => {
                        window.location.href = "/login.html";
                    }, 1000); // Redirect after 1 second
                } else {
                    messageElement.classList.remove("success");
                    messageElement.textContent = result.message || "Signup failed";
                }
            } catch (error) {
                messageElement.classList.remove("success");
                messageElement.textContent = "An error occurred. Please try again.";
            }
        });
    </script>
</body>
</html>